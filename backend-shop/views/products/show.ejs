<%- include('../layouts/sidebar') %>
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Chi ti·∫øt s·∫£n ph·∫©m</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-4">
    <h2 class="text-center mb-4">üîç Chi ti·∫øt s·∫£n ph·∫©m</h2>
    <div class="mb-3">
      <a href="/products" class="btn btn-secondary">&larr; Quay l·∫°i danh s√°ch</a>
    </div>
    <div class="card p-4 shadow-sm">
      <h4><%= product.name %></h4>
      <div class="mb-3">
        <strong>Gi√°:</strong> <%= product.price %> <br>
        <strong>S·ªë l∆∞·ª£ng:</strong> <%= product.quantity %> <br>
        <strong>Th∆∞∆°ng hi·ªáu:</strong> <%= product.brand %> <br>
        <strong>Xu·∫•t x·ª©:</strong> <%= product.origin %> <br>
        <strong>Danh m·ª•c:</strong> <%= product.category %> <br>
        <strong>M√¥ t·∫£:</strong> <%= product.description %> <br>
      </div>
      <div class="mb-3">
        <strong>H√¨nh ·∫£nh s·∫£n ph·∫©m:</strong>
        <% let imgs = product.images; %>
        <% if (!Array.isArray(imgs)) { try { imgs = JSON.parse(product.images); } catch(e) { imgs = []; } } %>
        <% if (Array.isArray(imgs) && imgs.length) { %>
          <div class="d-flex flex-wrap gap-2">
            <% for (let i = 0; i < imgs.length; i++) { %>
              <img src="<%= imgs[i] %>" alt="·∫¢nh" style="width:120px;height:120px;object-fit:cover;border-radius:4px;cursor:pointer;" onclick="showImageModal('<%= imgs[i] %>')">
            <% } %>
          </div>
          <div id="imageModal" class="modal" tabindex="-1" style="display:none;position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.7);align-items:center;justify-content:center;">
            <span onclick="closeImageModal()" style="position:absolute;top:30px;right:40px;font-size:2.5rem;color:#fff;cursor:pointer;font-weight:bold;z-index:10001;">&times;</span>
            <img id="modalImg" src="" style="max-width:90vw;max-height:80vh;box-shadow:0 0 20px #000;border-radius:8px;z-index:10000;">
          </div>
          <script>
            function showImageModal(src) {
              var modal = document.getElementById('imageModal');
              var img = document.getElementById('modalImg');
              img.src = src;
              modal.style.display = 'flex';
            }
            function closeImageModal() {
              document.getElementById('imageModal').style.display = 'none';
            }
            // ƒê√≥ng modal khi click ra ngo√†i ·∫£nh
            document.addEventListener('DOMContentLoaded', function() {
              var modal = document.getElementById('imageModal');
              if (modal) {
                modal.addEventListener('click', function(e) {
                  if (e.target === modal) closeImageModal();
                });
              }
            });
          </script>
        <% } else { %>
          <div class="text-muted">Ch∆∞a c√≥ h√¨nh ·∫£nh</div>
        <% } %>
      </div>
    </div>
  </div>
</body>
</html>
